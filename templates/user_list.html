<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Management</title>

  <!-- ‚úÖ Bootstrap CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', sans-serif;
    }
    .table-hover tbody tr:hover {
      background-color: #e9f5ff;
    }
    .admin-row {
      transition: all 0.2s ease-in-out;
    }
    .admin-row:hover {
      background-color: #cfe2ff !important;
    }
    .header-bar {
      background-color: gray;
      color: white;
      padding: 15px;
      border-radius: 6px;
    }
  </style>
</head>

<body>

<div class="container my-4">

  <!-- ‚úÖ Header Section -->
  <div class="header-bar mb-4 d-flex justify-content-between align-items-center">
    <h3 class="m-0">üë• User Management</h3>
    <a href="{% url 'super_admin' %}" class="btn btn-light btn-sm fw-bold">‚¨Ö Back to Dashboard</a>
  </div>

  <!-- ‚úÖ USERS TABLE -->
  <div class="card shadow-sm">
    <div class="card-header bg-secondary text-white fw-semibold">
      <i class="bi bi-people"></i> All Registered Users
    </div>
    <div class="card-body p-0">
      <table class="table table-bordered table-hover m-0">
        <thead class="table-light">
          <tr class="text-center align-middle">
            <!-- <th>ID</th> -->
            <th>Name</th>
            <th>User ID</th>
            <th>Type</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
          <tr 
            {% if user.usertype == 'ADMIN' %}
              class="admin-row" data-admin-id="{{ user.id }}" style="cursor:pointer;"
              title="Double click to view details"
            {% endif %}
          >
            <!-- <td class="text-center">{{ user.id }}</td> -->
            <td>{{ user.name }}</td>
            <td>{{ user.userid }}</td>
            <td class="text-center">
              {% if user.usertype == 'ADMIN' %}
                <span class="badge bg-info text-dark">Admin</span>
              {% elif user.usertype == 'IMAGING' %}
                <span class="badge bg-success">Imaging</span>
              {% elif user.usertype == 'RADS' %}
                <span class="badge bg-warning text-dark">RADS</span>
              {% else %}
                <span class="badge bg-secondary">Other</span>
              {% endif %}
            </td>
            <td class="text-center">
              {% if user.is_active %}
              <span class="badge bg-success">Active</span>
              {% else %}
              <span class="badge bg-danger">Inactive</span>
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr><td colspan="5" class="text-center text-muted py-3">No users found</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- ‚úÖ ADMIN DETAILS MODAL -->
  <div class="modal fade" id="adminDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content shadow-lg">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title">üë§ Admin Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>

        <div class="modal-body">
          <h5 id="adminName" class="text-primary mb-3"></h5>
          <div class="row g-3">
            <div class="col-md-6">
              <h6 class="text-success">üì∏ Imaging Users (<span id="imagingCount">0</span>)</h6>
              <table class="table table-sm table-bordered">
                <thead class="table-light">
                  <tr><th>Name</th><th>User ID</th></tr>
                </thead>
                <tbody id="imagingTableBody"></tbody>
              </table>
            </div>

            <div class="col-md-6">
              <h6 class="text-primary">ü©ª RADS Users (<span id="radsCount">0</span>)</h6>
              <table class="table table-sm table-bordered">
                <thead class="table-light">
                  <tr><th>Name</th><th>User ID</th></tr>
                </thead>
                <tbody id="radsTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- ‚úÖ JavaScript for double-click functionality -->
<script>

   

          // Set admin info
          document.getElementById('adminName').textContent = `üßë‚Äçüíº ${data.name} (${data.userid})`;
          document.getElementById('imagingCount').textContent = data.imaging_count;
          document.getElementById('radsCount').textContent = data.rads_count;

          // Clear and fill imaging table
          const imagingBody = document.getElementById('imagingTableBody');
          const radsBody = document.getElementById('radsTableBody');
          imagingBody.innerHTML = '';
          radsBody.innerHTML = '';

          data.imaging_list.forEach(u => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${u.name}</td><td>${u.userid}</td>`;
            imagingBody.appendChild(tr);
          });

          data.rads_list.forEach(u => {
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${u.name}</td><td>${u.userid}</td>`;
            radsBody.appendChild(tr);
          });

          // Show modal
          const modal = new bootstrap.Modal(document.getElementById('adminDetailsModal'));
          modal.show();
        
        .catch(err => {
          console.error(err);
          alert('Failed to load admin details');
        });
    
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.admin-row').forEach(row => {
    row.addEventListener('dblclick', function() {
      const adminId = this.dataset.adminId;
      // ‚úÖ ‡§Ö‡§¨ modal ‡§®‡§π‡•Ä‡§Ç ‡§ñ‡•Å‡§≤‡•á‡§ó‡§æ ‚Äî ‡§®‡§Ø‡§æ page ‡§ñ‡•Å‡§≤‡•á‡§ó‡§æ
      window.location.href = `/admin-details/${adminId}/`;
    });
  });
});
</script>


</body>
</html>
